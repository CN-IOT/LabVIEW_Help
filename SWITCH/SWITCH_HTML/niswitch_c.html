<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0099)file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/niswitch_c.html -->
<html class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="STYLESHEET" type="print/css" href="./niswitch_c_files/print.css">
<link rel="STYLESHEET" type="text/css" href="./niswitch_c_files/minimal.css">

<title>Using NI-SWITCH in Visual C/C++</title>
<script src="./niswitch_c_files/pdf.js.&#19979;&#36733;" type="text/javascript"></script>
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./niswitch_c_files/translateelement.css"></head>
<body bgcolor="#ffffff">
<h1><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">在 Visual C/C++ 中使用 NI-SWITCH</font></font></h1>

<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">本主题假设您使用 Microsoft Visual C 或 C++ ADE 来管理您的代码开发，并且您熟悉以下 ADE：</font></font></p>
<ul>
<li><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/niswitch_c.html#mv6"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">微软 Visual C++ 6.0</font></font></a>
<li><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/niswitch_c.html#ms2010"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">微软视觉工作室 2010</font></font></a></li>
</ul>


<h2><a name="mv6"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">在 Microsoft Visual C++ 6.0 中使用 NI-SWITCH</font></font></a></h2>
<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">要使用 Microsoft Visual C++ 6.0 开发 NI-SWITCH 应用程序，请遵循以下一般步骤：</font></font></p>
<ol>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">打开现有的或新的 Visual C/C++ 项目来管理您的应用程序代码。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">创建.c</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> (C) 或</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">.cpp</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> (C++)</font><font style="VERTICAL-ALIGN: inherit">类型的源代码文件  。</font></font> 
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">将源代码文件添加到项目中。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">在源代码文件中添加以下代码：
 </font></font><p class="Indent1"><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">#include “niswitch.h”</font></font></span></p>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">将 NI-SWITCH 包含和库文件添加到项目中。 

</font></font><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&lt;IVIROOTDIR32&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">是特定 National Instruments 文件夹位置的别名。</font><font style="VERTICAL-ALIGN: inherit">有关安装文件位置的详细信息，请参阅</font></font><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/related_documentation.html"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">NI-SWITCH 自述文件</font></font></a><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">。

</font></font><ol>
 <li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">项目»设置»C/C++»预处理器»附加包含目录</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">，然后将路径（以分号分隔）添加到</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.h</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">和</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">visa.h</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">文件。</font><font style="VERTICAL-ALIGN: inherit">niswitch.h</font><font style="VERTICAL-ALIGN: inherit">和</font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit">visa.h</font></span><font style="VERTICAL-ALIGN: inherit">文件分别位于&lt; </font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">IVIROOTDIR32 </font></font></span><font style="VERTICAL-ALIGN: inherit"><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit">&gt;</font></span></span><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"> \Include</font></span><font style="VERTICAL-ALIGN: inherit">和</font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit">&lt;VXIPNPPATH&gt;</font></span></span><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"> \WinNT\include</font></span><font style="VERTICAL-ALIGN: inherit">目录中。  </font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">项目»设置»链接»常规»对象/库模块</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">，然后添加</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">。</font></font> 
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">Project»Settings»Link»Input»Additional library path</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">，然后将路径添加到</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">文件。</font><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font><font style="VERTICAL-ALIGN: inherit">文件位于  &lt; </font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">IVIROOTDIR32 </font></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> \Lib\msc</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">或</font></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&lt;IVIROOTDIR32&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> \Lib x64\msc</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">目录中。</font></font></li>
</ol>
<li><font style="VERTICAL-ALIGN: inherit"></font><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/flow_basic.html"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">使用适当的编程流程</font></font></a><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">步骤</font><font style="VERTICAL-ALIGN: inherit">构建您的应用程序。</font></font></li> </ol>



<h2><a name="ms2010"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">在 Microsoft Visual Studio 2010 中使用 NI-SWITCH</font></font></a></h2>
<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">要使用 Microsoft Visual Studio 2010 开发 NI-SWITCH 应用程序，请遵循以下一般步骤：</font></font></p>
<ol>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">打开现有的或新的 Visual C/C++ 项目来管理您的应用程序代码。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">创建.c</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> (C) 或</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">.cpp</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> (C++)</font><font style="VERTICAL-ALIGN: inherit">类型的源代码文件  。</font></font> 
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">将源代码文件添加到项目中。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">在源代码文件中添加以下代码：
 </font></font><p class="Indent1"><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">#include “niswitch.h”</font></font></span></p>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">将 NI-SWITCH 包含和库文件添加到项目中。 
</font></font><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&lt;IVIROOTDIR32&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">是特定 National Instruments 文件夹位置的别名。</font><font style="VERTICAL-ALIGN: inherit">有关安装文件位置的详细信息，请参阅</font></font><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/related_documentation.html"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">NI-SWITCH 自述文件</font></font></a><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">。
</font></font><ol>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">Project»Properties»Configuration Properties»C/C++»General»Additional Include Directories</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">，将由分号分隔的路径添加到</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.h</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">和</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">visa.h</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">文件中。</font><font style="VERTICAL-ALIGN: inherit">niswitch.h</font><font style="VERTICAL-ALIGN: inherit">和</font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit">visa.h</font></span><font style="VERTICAL-ALIGN: inherit">文件分别位于&lt; </font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">IVIROOTDIR32 </font></font></span><font style="VERTICAL-ALIGN: inherit"><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit">&gt;</font></span></span><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"> \Include</font></span><font style="VERTICAL-ALIGN: inherit">和</font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit">&lt;VXIPNPPATH&gt;</font></span></span><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"> \WinNT\Visa\include</font></span><font style="VERTICAL-ALIGN: inherit">目录中。</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font></span><font style="VERTICAL-ALIGN: inherit"></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">项目»属性»配置属性»链接器»输入»附加依赖</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">项，然后添加</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">。</font></font> 
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">选择</font></font><strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">项目»属性»配置属性»链接器»常规»附加库目录</font></font></strong><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">，然后添加到</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">文件的路径。</font><font style="VERTICAL-ALIGN: inherit">niswitch.lib</font><font style="VERTICAL-ALIGN: inherit">文件位于&lt; </font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">IVIROOTDIR32 </font></font></span><font style="VERTICAL-ALIGN: inherit"></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> \Lib\msc</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">或</font></font><span class="Monospace"><span class="Monospace-Italic"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">&lt;IVIROOTDIR32&gt;</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit"> \Lib x64\msc</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">目录中。</font></font></li>
</ol>
<li><font style="VERTICAL-ALIGN: inherit"></font><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/flow_basic.html"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">使用适当的编程流程</font></font></a><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">步骤</font><font style="VERTICAL-ALIGN: inherit">构建您的应用程序。</font></font></li> </ol>

<h2><a name="ms2010"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">Microsoft Visual C 示例</font></font></a></h2>
<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">
已安装的 Visual C/C++ 示例位于</font></font><a href="file:///C:/Users/User/Documents/GitHub/LabVIEW_Help/LabVIEW_Help/SWITCH/SWITCH_HTML/related_documentation.html"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">NI-SWITCH 自述文件</font></font></a><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">中。
</font></font></p>
<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">
C 示例是使用带有 Service Pack 5.0 的 Microsoft Visual C++ 6.0 构建和测试的。</font><font style="VERTICAL-ALIGN: inherit">这些示例是基于控制台的，没有图形界面。
</font></font></p>
<p class="Body"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">
要使用 Microsoft NMAKE 实用程序在 Microsoft Visual C++ 6.0 中构建示例，请完成以下步骤：
</font></font></p><ol>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">转到您要使用的特定示例的目录。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">运行 VCVARS32.BAT 批处理文件（位于 MSVC 编译器的 \bin 目录中）以设置环境变量以供命令行使用（如果尚未设置）。</font><font style="VERTICAL-ALIGN: inherit">您可能需要增加 DOS 框的初始环境大小以适应添加的环境变量。</font></font>
<li><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">要构建示例，请运行</font></font><span class="Monospace"><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">nmake CFG="Win32 Debug"</font></font></span><font style="VERTICAL-ALIGN: inherit"><font style="VERTICAL-ALIGN: inherit">。</font><font style="VERTICAL-ALIGN: inherit">默认情况下，可执行文件构建到调试子目录。</font></font></li>
</ol>
<p></p>

<div class="goog-te-spinner-pos">&nbsp;</div></body></html>